# Базы данных и схемы

По умолчанию в кластере БД создаётся 3 БД:

- postgres - подключение по умолчанию
- template0 - не изменяется
- template1 - общие изменения, новая БД

Новые БД всегда создаются из существующей БД.

## Получение списка БД

Из консоли:

```
psql -l
```

Из системной таблицы:

```
SELECT datname, datistemplate, dateallowconn, datconnlimit
FROM pg_database;
```

## Схемы

Все объекты принадлежат каким-либо схемам.

Список существующих схем:
```
\dn
```

Список таблиц:
```
\dt
```

Сменить схему таблицы:
```
ALTER TABLE t SET SCHEMA app;
```

## Путь поиска

Квалифицированное имя объекта: `схема.объект`

`search_path` - путь поиска

Реальное значение показывает команда `current_schemas`

```
SELECT current_schemas(true);
```

Есть специальные схемы:

- public
- совпадающая с именем польз-ля
- pg_catalog

По умолчанию, search_path: `"$user", public`

Можно установить search_path для подключений к конкретной БД:

```
ALTER DATABASE app SET search_path = public.app;
```

## Временные таблицы

- Существуют на время сеанса или транзакции
- Не журналируются
- Не попадают в общий буферный кэш

Схема `pg_temp_N`

- автомат-ки создаётся для временных таблиц
- pg_temp - ссылка на конкр-ную временную схему данного сеанса

